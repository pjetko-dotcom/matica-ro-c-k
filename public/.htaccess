# ══════════════════════════════════════════════════════════════════════════════
#  Matica RO(C)K – Apache konfigurácia
#  Umiestnenie na serveri: fourseasons.sk/matica-ro(c)k/.htaccess
# ══════════════════════════════════════════════════════════════════════════════

Options -Indexes

# ── React SPA routing ─────────────────────────────────────────────────────────
# Všetky requesty na neexistujúce súbory/priečinky presmeruje na index.html
# aby React Router mohol spracovať URL na klientskej strane.

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /matica-ro\(c\)k/

    # Preskočiť ak súbor skutočne existuje (JS, CSS, PHP, obrázky...)
    RewriteCond %{REQUEST_FILENAME} !-f
    # Preskočiť ak priečinok skutočne existuje
    RewriteCond %{REQUEST_FILENAME} !-d
    # Všetko ostatné → index.html
    RewriteRule ^ index.html [L]
</IfModule>

# ── GZIP kompresia ────────────────────────────────────────────────────────────
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/css application/javascript application/json
</IfModule>

# ── Cache hlavičky pre statické assety ───────────────────────────────────────
<IfModule mod_expires.c>
    ExpiresActive On
    # JS a CSS (Vite generuje hash v názve – cache natrvalo)
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType text/css               "access plus 1 year"
    # index.html nikdy necachuj (vždy čerstvý)
    <Files "index.html">
        ExpiresDefault "access plus 0 seconds"
        Header set Cache-Control "no-store, no-cache, must-revalidate"
    </Files>
</IfModule>

# ── Bezpečnostné hlavičky ─────────────────────────────────────────────────────
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# ── Skryť PHP súbory v api/ pred priamym výpisom ─────────────────────────────
# api/sync.php je dostupné iba cez ?code= parameter, nie cez prehliadač adresára
<Files "*.php">
    # PHP súbory sú spracované serverom, nie servírované ako text
</Files>
